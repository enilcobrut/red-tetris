{"version":3,"sources":["../../../../src/server/lib/incremental-cache/fetch-cache.ts"],"names":["LRUCache","CACHE_ONE_YEAR","NEXT_CACHE_SOFT_TAGS_HEADER","rateLimitedUntil","memoryCache","CACHE_TAGS_HEADER","CACHE_HEADERS_HEADER","CACHE_STATE_HEADER","CACHE_REVALIDATE_HEADER","CACHE_FETCH_URL_HEADER","CACHE_CONTROL_VALUE_HEADER","FetchCache","hasMatchingTags","arr1","arr2","length","set1","Set","set2","size","tag","has","isAvailable","ctx","_requestHeaders","process","env","SUSPENSE_CACHE_URL","constructor","debug","NEXT_PRIVATE_DEBUG_CACHE","headers","newHeaders","JSON","parse","k","scHost","scBasePath","SUSPENSE_CACHE_BASEPATH","SUSPENSE_CACHE_AUTH_TOKEN","cacheEndpoint","console","log","maxMemoryCacheSize","max","value","kind","stringify","props","Error","data","body","html","pageData","resetRequestCache","reset","revalidateTag","Date","now","res","fetch","encodeURIComponent","method","next","internal","status","retryAfter","get","parseInt","ok","err","warn","args","key","tags","softTags","kindHint","fetchIdx","fetchUrl","hasFetchKindAndMatchingTags","start","fetchParams","fetchType","join","error","text","cached","json","include","push","cacheState","age","lastModified","Object","keys","set","fetchCache","revalidate","toString","undefined"],"mappings":"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"}